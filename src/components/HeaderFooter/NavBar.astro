---
import MobileNav from "./MobileNav.astro";
---

<nav
  class="backdrop-blur-md bg-[#171717]/80 shadow-md fixed top-0 left-0 w-full z-50 border-b border-[#ffffff]/10"
  role="navigation"
  aria-label="Main navigation"
>
  <div class="px-4 sm:px-6 lg:px-8">
    <div class="flex justify-between items-center h-16">
      <!-- Mobile Menu Toggle Button -->
      <div class="flex items-center bg-card rounded-lg md:hidden p-2">
        <a href="/" aria-label="Home">
          <svg
            class="w-6 h-6"
            fill="none"
            stroke="currentColor"
            viewBox="0 0 24 24"
            stroke-width="1.5"
            stroke-linecap="round"
            stroke-linejoin="round"
          >
            <path d="M5 12l-2 0l9 -9l9 9l-2 0"></path>
            <path d="M5 12v7a2 2 0 0 0 2 2h10a2 2 0 0 0 2 -2v-7"></path>
            <path d="M9 21v-6a2 2 0 0 1 2 -2h2a2 2 0 0 1 2 2v6"></path>
          </svg>
        </a>
      </div>

      <!-- Logo -->
      <a href="/">
        <div class="flex-1 flex justify-center md:justify-start">
          <img
            src="/assets/spritle.svg"
            alt="Spritle Logo"
            class="lg:h-8 lg:w-24 h-8 w-30"
          />
        </div>
      </a>

      <!-- Desktop Menu -->
      <div class="hidden md:flex space-x-6 items-center">
        <!-- AI Solutions Link -->
        <a
          href="/aisolution"
          class="text-primary text-sm hover:bg-card focus:bg-card px-3 py-2 rounded-lg transition duration-300 focus:outline-none"
          >AI Solutions</a
        >

        <!-- Services Dropdown -->
        <div class="relative group">
          <button
            id="servicesToggle"
            class="text-primary text-sm px-3 py-2 rounded-t-xl transition duration-300 flex items-center hover:bg-card focus:bg-card focus:outline-none"
            aria-haspopup="true"
            aria-expanded="false"
            aria-controls="servicesMenu"
          >
            Services
            <svg
              id="servicesArrow"
              class="w-4 h-4 ml-1 transform transition-transform duration-300"
              fill="none"
              stroke="currentColor"
              viewBox="0 0 24 24"
            >
              <path
                stroke-linecap="round"
                stroke-linejoin="round"
                stroke-width="2"
                d="M19 9l-7 7-7-7"></path>
            </svg>
          </button>
          <div
            id="servicesMenu"
            class="absolute hidden p-3 bg-card mt-[1px] rounded-lg rounded-tl-none shadow-lg w-64 z-50"
            role="menu"
            aria-label="Services"
          >
            <ul>
              <li>
                <a
                  href="/genaisolution"
                  role="menuitem"
                  tabindex="0"
                  class="block text-primary text-sm px-4 py-2 hover:bg-[#404040] focus:bg-[#404040] hover:rounded-lg focus:rounded-lg focus:outline-none"
                  >Gen AI Solution</a
                >
              </li>
              <li>
                <a
                  href="/visionai"
                  role="menuitem"
                  tabindex="0"
                  class="block text-primary text-sm px-4 py-2 hover:bg-[#404040] focus:bg-[#404040] hover:rounded-lg focus:rounded-lg focus:outline-none"
                  >Vision AI</a
                >
              </li>
              <li>
                <a
                  href="/custom"
                  role="menuitem"
                  tabindex="0"
                  class="block text-primary text-sm px-4 py-2 hover:bg-[#404040] focus:bg-[#404040] hover:rounded-lg focus:rounded-lg focus:outline-none"
                  >Custom Software Development</a
                >
              </li>
              <li>
                <a
                  href="/ai-ml-solutions"
                  role="menuitem"
                  tabindex="0"
                  class="block text-primary text-sm px-4 py-2 hover:bg-[#404040] focus:bg-[#404040] hover:rounded-lg focus:rounded-lg focus:outline-none"
                  >AI & ML Solutions</a
                >
              </li>
              <li>
                <a
                  href="/datascience-bigdata"
                  role="menuitem"
                  tabindex="0"
                  class="block text-primary text-sm px-4 py-2 hover:bg-[#404040] focus:bg-[#404040] hover:rounded-lg focus:rounded-lg focus:outline-none"
                  >DataScience & BigData</a
                >
              </li>
              <li>
                <a
                  href="/cloud-devops"
                  role="menuitem"
                  tabindex="0"
                  class="block text-primary text-sm px-4 py-2 hover:bg-[#404040] focus:bg-[#404040] hover:rounded-lg focus:rounded-lg focus:outline-none"
                  >Cloud & Devops</a
                >
              </li>
              <li>
                <a
                  href="/ui-ux"
                  role="menuitem"
                  tabindex="0"
                  class="block text-primary text-sm px-4 py-2 hover:bg-[#404040] focus:bg-[#404040] hover:rounded-lg focus:rounded-lg focus:outline-none"
                  >UI/UX</a
                >
              </li>
              <li>
                <a
                  href="/it-consulting"
                  role="menuitem"
                  tabindex="0"
                  class="block text-primary text-sm px-4 py-2 hover:bg-[#404040] focus:bg-[#404040] hover:rounded-lg focus:rounded-lg focus:outline-none"
                  >IT Consulting</a
                >
              </li>
              <li>
                <a
                  href="/quality-assurance-testing"
                  role="menuitem"
                  tabindex="0"
                  class="block text-primary text-sm px-4 py-2 hover:bg-[#404040] focus:bg-[#404040] hover:rounded-lg focus:rounded-lg focus:outline-none"
                  >Quality Assurance & Testing</a
                >
              </li>
              <li>
                <a
                  href="/maintainance-and-support"
                  role="menuitem"
                  tabindex="0"
                  class="block text-primary text-sm px-4 py-2 hover:bg-[#404040] focus:bg-[#404040] hover:rounded-lg focus:rounded-lg focus:outline-none"
                  >Maintenance and Support</a
                >
              </li>
            </ul>
          </div>
        </div>

        <!-- Industries Dropdown for Laptop -->
        <div class="relative group">
          <button
            id="industriesDropdownToggleDesktop"
            class="text-primary text-sm px-3 py-2 rounded-t-xl transition duration-300 flex items-center group-hover:bg-card focus:outline-none hover:bg-card focus:bg-card"
            aria-haspopup="true"
            aria-expanded="false"
            aria-controls="industriesDropdownDesktop"
          >
            Industries
            <svg
              id="industriesArrowDesktop"
              class="w-4 h-4 ml-1 transform transition-transform duration-300"
              fill="none"
              stroke="currentColor"
              viewBox="0 0 24 24"
            >
              <path
                stroke-linecap="round"
                stroke-linejoin="round"
                stroke-width="2"
                d="M19 9l-7 7-7-7"></path>
            </svg>
          </button>
          <!-- Dropdown Menu Industries -->
          <ul
            id="industriesDropdownDesktop"
            class="absolute hidden bg-card p-3 mt-[1px] rounded-lg rounded-tl-none shadow-lg w-64"
            role="menu"
            aria-label="Industries Dropdown"
          >
            <li role="none">
              <a
                href="/healthcare-industry"
                class="block text-primary text-sm px-4 py-2 hover:bg-[#404040] focus:bg-[#404040] hover:rounded-lg focus:rounded-lg focus:outline-none"
                role="menuitem"
                tabindex="-1"
              >
                Healthcare Industry
              </a>
            </li>
            <li role="none">
              <a
                href="/aviation-industry"
                class="block text-primary text-sm px-4 py-2 hover:bg-[#404040] focus:bg-[#404040] hover:rounded-lg focus:rounded-lg focus:outline-none"
                role="menuitem"
                tabindex="-1"
              >
                Aviation Industry
              </a>
            </li>
            <li role="none">
              <a
                href="/education-industry"
                class="block text-primary text-sm px-4 py-2 hover:bg-[#404040] focus:bg-[#404040] hover:rounded-lg focus:rounded-lg focus:outline-none"
                role="menuitem"
                tabindex="-1"
              >
                Education Industry
              </a>
            </li>
            <li role="none">
              <a
                href="/manufacturing-industry"
                class="block text-primary text-sm px-4 py-2 hover:bg-[#404040] focus:bg-[#404040] hover:rounded-lg focus:rounded-lg focus:outline-none"
                role="menuitem"
                tabindex="-1"
              >
                Manufacturing Industry
              </a>
            </li>
            <li role="none">
              <a
                href="/ecommerce-industry"
                class="block text-primary text-sm px-4 py-2 hover:bg-[#404040] focus:bg-[#404040] hover:rounded-lg focus:rounded-lg focus:outline-none"
                role="menuitem"
                tabindex="-1"
              >
                Ecommerce Industry
              </a>
            </li>
            <li role="none">
              <a
                href="/lifescience-industry"
                class="block text-primary text-sm px-4 py-2 hover:bg-[#404040] focus:bg-[#404040] hover:rounded-lg focus:rounded-lg focus:outline-none"
                role="menuitem"
                tabindex="-1"
              >
                Life Science Industry
              </a>
            </li>
            <li role="none">
              <a
                href="/transportation-logistic-industry"
                class="block text-primary text-sm px-4 py-2 hover:bg-[#404040] focus:bg-[#404040] hover:rounded-lg focus:rounded-lg focus:outline-none"
                role="menuitem"
                tabindex="-1"
              >
                Transportation & Logistics Industry
              </a>
            </li>
            <li role="none">
              <a
                href="/cpaas-industry"
                class="block text-primary text-sm px-4 py-2 hover:bg-[#404040] focus:bg-[#404040] hover:rounded-lg focus:rounded-lg focus:outline-none"
                role="menuitem"
                tabindex="-1"
              >
                CPaaS Industry
              </a>
            </li>
            <li role="none">
              <a
                href="/energy-utility-services"
                class="block text-primary text-sm px-4 py-2 hover:bg-[#404040] focus:bg-[#404040] hover:rounded-lg focus:rounded-lg focus:outline-none"
                role="menuitem"
                tabindex="-1"
              >
                Energy & Utilities Industry
              </a>
            </li>
          </ul>
        </div>

        <!-- Other Menu Links -->
        <a
          href="/works"
          class="text-primary text-sm hover:bg-card focus:bg-card px-3 py-2 rounded-lg transition duration-300 focus:outline-none"
          >Works</a
        >

        <a
          href="/about"
          class="text-primary text-sm hover:bg-card focus:bg-card px-3 py-2 rounded-lg transition duration-300 focus:outline-none"
          >About</a
        >

        <a
          href="/career"
          class="text-primary text-sm hover:bg-card focus:bg-card px-3 py-2 rounded-lg transition duration-300 focus:outline-none"
          >Career</a
        >

        <a
          href="/contact"
          class="bg-[#15AED5] text-primary px-4 py-2 rounded-full hover:bg-card focus:bg-card transition duration-300 text-sm focus:outline-none"
          >Contact us</a
        >
      </div>

      <!-- Mobile Menu Toggle Button -->
      <button
        id="mobileMenuButton"
        class="flex items-center cursor-pointer bg-background rounded-lg md:hidden p-2 focus:outline-none relative w-10 h-10 group"
        aria-label="Toggle menu"
        aria-expanded="false"
      >
        <span
          class="absolute top-2.5 left-2 w-6 h-0.5 bg-white transition-all duration-300 origin-center mt-1"
        ></span>
        <span
          class="absolute top-5 left-2 w-6 h-0.5 bg-white transition-all duration-300 origin-center mt-1"
        ></span>
      </button>
    </div>
  </div>
</nav>

<MobileNav />

<script lang="js">
  const mobileBtn = document.getElementById("mobileMenuButton");
  const mobileMenu = document.getElementById("mobileMenu");

  mobileBtn.addEventListener("click", () => {
    mobileMenu.classList.toggle("hidden");
    mobileBtn.classList.toggle("open");
  });
  const setupDesktopDropdown = (toggleId, menuId, arrowId) => {
    const toggle = document.getElementById(toggleId);
    const menu = document.getElementById(menuId);
    const arrow = arrowId ? document.getElementById(arrowId) : null;

    if (!toggle || !menu) return;

    toggle.addEventListener("click", (e) => {
      e.preventDefault();
      const expanded = toggle.getAttribute("aria-expanded") === "true";
      toggle.setAttribute("aria-expanded", !expanded);
      menu.classList.toggle("hidden");
      if (arrow) arrow.classList.toggle("rotate-180");
    });

    toggle.addEventListener("keydown", (e) => {
      if (e.key === "Enter" || e.key === " ") {
        e.preventDefault();
        toggle.click();
      } else if (e.key === "ArrowDown") {
        e.preventDefault();
        const firstLink = menu.querySelector("a");
        if (firstLink) firstLink.focus();
      }
    });

    menu.querySelectorAll("a").forEach((link, index, links) => {
      link.addEventListener("keydown", (e) => {
        if (e.key === "ArrowDown") {
          e.preventDefault();
          if (index < links.length - 1) links[index + 1].focus();
        } else if (e.key === "ArrowUp") {
          e.preventDefault();
          if (index > 0) links[index - 1].focus();
          else toggle.focus();
        } else if (e.key === "Escape") {
          toggle.setAttribute("aria-expanded", false);
          menu.classList.add("hidden");
          toggle.focus();
        }
      });
    });

    document.addEventListener("click", (e) => {
      if (!toggle.contains(e.target) && !menu.contains(e.target)) {
        toggle.setAttribute("aria-expanded", false);
        menu.classList.add("hidden");
      }
    });
  };

  setupDesktopDropdown("servicesToggle", "servicesMenu", "servicesArrow");
  setupDesktopDropdown(
    "industriesDropdownToggleDesktop",
    "industriesDropdownDesktop",
    "industriesArrowDesktop"
  );
</script>
