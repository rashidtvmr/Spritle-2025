---
import ronaldrichards from "../../assets/images/home/ronaldrichards.png";
import savannah from "../../assets/images/home/savannah.png";
import floydmiles from "../../assets/images/home/floydmiles.png";
import { Image } from "astro:assets";

const testimonials = [
  {
    name: "Floyd Miles",
    rating: 4,
    description:
      "Amet minim mollit non deserunt ullamco est sit aliqua dolor do amet sint. Velit officia consequat duis enim velit mollit. Exercitation veniam consequat sunt nostrud amet. Amet minim mollit non deserunt ullamco est sit aliqua dolor do amet sint. Velit officia consequat duis enim velit mollit. Exercitation veniam consequat sunt nostrud amet.",
    image: floydmiles,
  },
  {
    name: "Ronald Richards",
    rating: 5,
    description:
      "Ullamco est sit aliqua dolor do amet sint. Velit officia consequat duis enim velit mollit. Exercitation veniam consequat sunt nostrud amet.",
    image: ronaldrichards,
  },
  {
    name: "Savannah Nguyen",
    rating: 4,
    description:
      "Amet minim mollit non deserunt ullamco est sit aliqua dolor do amet sint. Velit officia consequat duis enim velit mollit. Exercitation veniam consequat sunt nostrud amet. Amet minim mollit non deserunt ullamco est sit aliqua dolor do amet sint. Velit officia consequat duis enim velit mollit. Exercitation veniam consequat sunt nostrud amet.",
    image: savannah,
  },
  {
    name: "Jane Cooper",
    rating: 5,
    description:
      "Exceptional service! The team went above and beyond my expectations.",
    image: ronaldrichards,
  },
  {
    name: "Robert Fox",
    rating: 4,
    description:
      "Very professional and efficient. The results were exactly what I was looking for.",
    image: savannah,
  },
  {
    name: "Leslie Alexander",
    rating: 5,
    description:
      "Outstanding experience from start to finish. The attention to detail was impeccable.",
    image: floydmiles,
  },
  {
    name: "Jenny Wilson",
    rating: 4,
    description:
      "Incredible results! The team was responsive and delivered exactly what we needed.",
    image: savannah,
  },
  {
    name: "Wade Warren",
    rating: 5,
    description:
      "Top-notch service and expertise. They made the process smooth and stress-free.",
    image: floydmiles,
  },
  {
    name: "Cameron Wright",
    rating: 4,
    description:
      "Fantastic work! They understood our requirements perfectly and delivered beyond expectations.",
    image: ronaldrichards,
  },
];
---

<div class="space-y-1 lg:space-y-6 md:space-y-3 my-10 md:my-20 overflow-hidden">
  <div class="text-left md:mb-8 flex flex-col md:flex-row justify-between">
    <div>
      <h2 class="text-heading text-primary font-medium mb-0 md:mb-4">
        Our Customer Feedback
      </h2>
      <p
        class="text-subtitle max-w-[968px] mt-4 md:mt-10 mb-5 md:mb-20 font-medium text-secondary"
      >
        Don't take our word for it. Trust our customers
      </p>
    </div>
    <div class="hidden md:flex gap-4 justify-center md:justify-start md:mt-5">
      <button
        id="prevButton"
        class="hover:bg-gray-600 text-white font-bold rounded-md focus:outline-none border-2 w-[123px] h-[48px] p-2 disabled:opacity-50 disabled:cursor-not-allowed"
      >
        <span class="text-[#9BD609]">&lt;</span> Previous
      </button>
      <button
        id="nextButton"
        class="hover:bg-gray-600 text-white font-bold rounded-md focus:outline-none border-2 w-[113px] h-[48px] p-2 disabled:opacity-50 disabled:cursor-not-allowed"
      >
        Next <span class="text-[#9BD609]">&gt;</span>
      </button>
    </div>
  </div>
  <div
    id="testimonials-unique"
    class="swiper-container relative overflow-hidden"
    style={{
      "--swiper-pagination-color": "#9BD609",
      "--swiper-pagination-bullet-inactive-color": "#9BD6094D  ",
      "--swiper-pagination-bullet-inactive-opacity": "1",
      "--swiper-pagination-bullet-size": "12px",
      "--swiper-pagination-bullet-horizontal-gap": "6px",
    }}
  >
    <div class="swiper-wrapper">
      {
        testimonials.map((t, index) => (
          <div class="swiper-slide" key={index}>
            <div class="rounded-lg p-6 border flex flex-col md:h-[300px] lg:h-[389px] pb-3">
              <div class="flex flex-col items-center justify-center space-y-2 md:flex-row md:justify-between md:items-center pb-4">
                <Image
                  src={t.image}
                  alt={t.name}
                  class="w-16 h-16 lg:w-[80px] lg:h-[80px] mb-4 md:mb-0"
                />
                <div class="flex space-x-1">
                  {"★"
                    .repeat(t.rating)
                    .padEnd(5, "☆")
                    .split("")
                    .map((s, i) => (
                      <span
                        key={i}
                        class={`${s === "★" ? "text-yellow-500" : "text-gray-500"} text-3xl md:text-3xl`}
                      >
                        {s}
                      </span>
                    ))}
                </div>
              </div>
              <div class="flex flex-col items-center text-center md:items-start md:text-left">
                <h3 class="text-white font-semibold text-subtitle  text-center">
                  {t.name}
                </h3>
                <p
                  class="font-medium text-white lg:max-w-[483.56px] lg:max-h-[163.33px] md:max-h-[113.33px] overflow-hidden text-ellipsis md:mt-5 mt-3  text-body"
                  style={{
                    display: "-webkit-box",
                    WebkitLineClamp: 5,
                    WebkitBoxOrient: "vertical",
                  }}
                >
                  {t.description}
                </p>
              </div>
            </div>
          </div>
        ))
      }
    </div>
    <!-- Swiper Pagination -->
    <div class="swiper-pagination"></div>
  </div>

  <!-- Pagination Buttons Container -->
  <div id="paginationButtons" class="flex justify-center gap-2 md:mt-10"></div>
  <div class="flex justify-between md:hidden">
    <button
      id="prevButton"
      class="hover:bg-gray-600 text-white font-bold rounded-md focus:outline-none border-2 w-[123px] h-[48px] p-2 disabled:opacity-50 disabled:cursor-not-allowed"
    >
      <span class="text-[#9BD609]">&lt;</span> Previous
    </button>
    <button
      id="nextButton"
      class="hover:bg-gray-600 text-white font-bold rounded-md focus:outline-none border-2 w-[113px] h-[48px] p-2 disabled:opacity-50 disabled:cursor-not-allowed"
    >
      Next <span class="text-[#9BD609]">&gt;</span>
    </button>
  </div>
</div>

<script type="module">
  import Swiper from "swiper";
  import { Navigation, Pagination } from "swiper/modules";
  import "swiper/css";
  import "swiper/css/navigation";
  import "swiper/css/pagination";
  document.addEventListener("DOMContentLoaded", () => {
    const swiper = new Swiper("#testimonials-unique", {
      modules: [Pagination, Navigation],
      slidesPerView: 1,
      slidesPerGroup: 1, // Ensure pagination moves one slide at a time
      spaceBetween: 16,
      pagination: {
        el: ".swiper-pagination",
        clickable: true,
      },
      navigation: {
        nextEl: "#nextButton",
        prevEl: "#prevButton",
      },
      breakpoints: {
        768: { slidesPerView: 2, slidesPerGroup: 2 }, // Update here too
        1024: { slidesPerView: 3, slidesPerGroup: 3 }, // And here
      },
    });

    const prevButton = document.getElementById("prevButton");
    const nextButton = document.getElementById("nextButton");

    // Update button states on slide change
    swiper.on("slideChange", () => {
      prevButton.disabled = swiper.isBeginning;
      nextButton.disabled = swiper.isEnd;
    });

    // Initialize button states
    prevButton.disabled = swiper.isBeginning;
    nextButton.disabled = swiper.isEnd;
  });
</script>

<style>
  .swiper-pagination-bullet {
  }
  /* Custom styles for pagination bullets */
  #testimonials-unique .swiper-pagination .swiper-pagination-bullet {
    background-color: !important;
    --swiper-theme-color: #9bd6094d !important;

    width: 20px !important;
    height: 20px !important;
    border-radius: 50% !important;
    display: inline-block !important;
    margin: 0 4px !important;
    cursor: pointer !important;
    transition: background-color 0.3s ease !important;
  }

  #testimonials-unique .swiper-pagination .swiper-pagination-bullet-active {
    background-color: #9bd609 !important;
  }

  /* Ensure Swiper pagination container is visible */
  #testimonials-unique .swiper-pagination {
    position: relative !important;
    text-align: center !important;
    margin-top: 20px !important; /* Add margin to position pagination below the card */
  }
  #testimonials-unique {
    --swiper-theme-color: #9bd609;
  }
  @media (max-width: 767px) {
    /* Button Container */
    .flex.justify-center.gap-4 {
      margin-top: 16px; /* Add space between pagination and buttons */
    }

    /* Buttons */
    #prevButtonMobile,
    #nextButtonMobile {
      width: 120px; /* Adjust button width for mobile */
      height: 40px; /* Adjust button height for mobile */
      font-size: 14px; /* Adjust font size for mobile */
    }
  }

  /* Hide mobile buttons on desktop */
</style>
